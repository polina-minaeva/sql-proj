# sql-proj
Анализ базы данных по авиаперевозкам, получение данных по самолетам, маршрутам, пассажирам, местам в самолетах, стоимости билетов и бронирования

Я решала несколько задач:
1. Вывела названия самолётов, которые имеют менее 50 посадочных мест. Для присоединения таблицы использовала join, группировала данные по самолетам с помощью group by, выводила только данные с менее 50 посадочных мест с помощью having count(s.seat_no) < 50
2. Вывела процентное изменение ежемесячной суммы бронирования билетов, округленной до сотых. Сгруппировала значения по месяцам с помощью date_trunc('month', book_date), узнала сумму бронирования для каждого месяца с помощью оконной функции sum(total_amount) over (partition by months), использовала coalesce для замены null на исходное значение, обозначенное как 100%, узнала процентное изменение по сравнению с предыдущим значением с помощью функции lag, округлила значение с помощью round
3. Вывела названия самолётов без бизнес-класса. Использовала в решении функцию array_agg для превращения данных в массив, оператор join для присоединения таблицы, оператор array_position для отбора данных, в которых нет слова Business: having array_position(conditions, 'Business') is null.
4. 
